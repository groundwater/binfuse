#!/usr/bin/env ruby

require 'json'

if ARGV.length < 1
  puts "Please Specify a Deployment File"
  exit -1
end

config = JSON.parse open(ARGV.shift).read

TARGET=config['target']
AMI_ID=config['ami']
SUBIDS=config['subnets']
ENVIRO=config['environment']
ELBIDS=config['elb']

loadbal="--elb #{ELBIDS}"              if ELBIDS
subnets="--subets #{SUBIDS}"           if SUBIDS
environ="--environment #{ENVIRO}"      if ENVIRO

ROOT_DIR     = File.expand_path File.join( __FILE__, "..")
CREATE_SCALE = File.join ROOT_DIR, 'binfuse-deploy-group'

# Boot the Auto Scale Group
puts "#{CREATE_SCALE} #{TARGET} #{AMI_ID} #{LOADBAL} #{USERDAT} #{subnets} #{environ}"
